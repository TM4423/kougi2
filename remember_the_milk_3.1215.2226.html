<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Remember the Milk Concept Showcase</title>
    <script src="js/jquery-2.1.3.min.js"></script>
    <link rel="stylesheet" href="css/sample.css">
    <script>
        // 初期値（場所）を設定する
        const default_setItem_place = [ 'サツドラ', 'EZO HUB', 'セブンイレブン', 'ホーマック', '札幌駅'];
        for (let i = 0; i < default_setItem_place.length; i++) {
            localStorage.setItem(default_setItem_place[i], '');
        }
        // alert(`次の初期値を入力しました ${default_setItem_place}`);
        // 初期値（商品名）をlocalStrageへ設定する
        const default_setItem_name = ['ビタアルト 80', '活蔘 800','強炭酸水 68','森彦の缶コーヒー 198','メロンパン 150','カレーパン 380','ジャムおじさん 92',];
        for (let i = 0; i < default_setItem_name.length; i++) {
            localStorage.setItem(default_setItem_name[i], '');
        }
        // alert(`次の初期値を入力しました ${default_setItem_name}`);
        

    </script>
</head>

<body>
    <header>
        <h1>Remember the Milk Concept Showcase</h1>
    </header>
    <main style="display: none;">
        <!--入力エリア-->
        現在地<input type="text" value='' name="loc" id="loc" class="box" placeholder="location?">
        価格<input type="text" value='' name="price" id="price" class="box" placeholder="price?">
        商品名<input type="text" value='' name="name" id="name" class="box" placeholder="Product's name?">
        <ul>
            <li id='save'>欲しいものリストを書き込む</li>
            <li id='clear'>クリアする</li>
            <li id='total'>計算する</li>
        </ul>
        <!-- <div id="suggestedItems" style="display: none;"> -->
            <h1>買ったものリスト</h1>
        <div id="suggestedItems">
            <!--ここに、過去に買ったもののボタンを表示する。ただし、
                現在地によって内容が変わる。
            -->
        </div>
    </main>
    <h1>localStorageの内容</h2>
    <table id="list" style="display: none;">
        <!-- ここに追加データが挿入される -->
    </table>
    <script>
    $('main').slideDown(1000);
    $('#suggestedItems').slideDown(1000);
    $('table').fadeIn(5000);

        //1.Save クリックイベント----------------------------------------------------------

        $('#save').on('click', function () {
            const loc = $('#loc').val();
            const price = $('#price').val();
            const name = $('#name').val();
            const stamp = new Date;
            if (loc && price && name) {
                localStorage.setItem(`${price}円の${name} ${loc}`,price);
            }else if (price && name) {
                localStorage.setItem(`${price}円の${name}`,loc);
            }else if (name) {
                localStorage.setItem(`${name}`,price);
            }
            //品名と値段
            localStorage.setItem(`${name} ${price}`, price) 
            
            //場所と品名
            localStorage.setItem(`${loc} ${name}`, loc);    

            //時間を使って、ユニークなkeyを作る実験
            if ((name)&&(price)) {
                localStorage.setItem(`${name} ${stamp}`,`${price}円の${name}`);
            }
            
            //文字列を格納する実験
            localStorage.setItem(`${price}円の ${name}`,price); 

            // オブジェクトを格納する実験 JSON
            let obj = { 'name': name, 'price': price, 'loc': loc, 'stamp': stamp }
            let json_text = JSON.stringify(obj);
            localStorage.setItem('key', obj);

            //オブジェクトをkeyにする実験 JSON
            key = { 'name': 'name', 'price': price }; 
            localStorage.setItem(key, obj);
            alert(json_text);

            // 一覧に追加（前方へ追加する）
            const html = '<tr><th>' + key + '</th><td>' + obj + '</td></tr>';
            $('#list').prepend(html);
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            const value = localStorage.getItem(key);

            const html = '<tr><th>' + key + '</th><td>' + value + '</td></tr>';
            $('#list').append(html);
        }
        })

        //2.clear クリックイベント

        $('#clear').on('click', function () {
            localStorage.clear();
            $('#list').empty;
            // htmlを空にして、書き換える
            const html = '';
            $('#list').html(html);
        })




        // //3.ページ読み込み：保存データ取得表示


        //4. totalを計算する


        //5. 現在地を書き換えたとき、onchangeのイベントを発生させる
        $('#loc').on('change', function () {
            alert('OK');
        })


    </script>
    <footer><small>G's</small></footer>
</body>

</html>